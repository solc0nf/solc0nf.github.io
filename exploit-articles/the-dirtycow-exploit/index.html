<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.108.0">
    <meta name="generator" content="Relearn 5.9.4+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="Exploit writeups, info sec articles..">
    <meta name="author" content="solc0nf">
    <title>The Dirtycow Exploit :: solc0nf</title>
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1690804204" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1690804204" rel="stylesheet"></noscript>
    <link href="/css/featherlight.min.css?1690804204" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/featherlight.min.css?1690804204" rel="stylesheet"></noscript>
    <link href="/css/auto-complete.css?1690804204" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1690804204" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1690804204" rel="stylesheet">
    <link href="/css/nucleus.css?1690804204" rel="stylesheet">
    <link href="/css/fonts.css?1690804204" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1690804204" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1690804204" rel="stylesheet">
    <link href="/css/theme-relearn-dark.css?1690804204" rel="stylesheet" id="variant-style">
    <link href="/css/ie.css?1690804204" rel="stylesheet">
    <link href="/css/variant.css?1690804204" rel="stylesheet">
    <link href="/css/print.css?1690804204" rel="stylesheet" media="print">
    <script src="/js/url.js?1690804204"></script>
    <script src="/js/variant.js?1690804204"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/solc0nf.github.io/';
      window.variants && variants.init( [ 'relearn-dark' ] );
    </script>
    <script src="/js/jquery.min.js?1690804204" defer></script>
  </head>
  <body class="mobile-support html disableInlineCopyToClipboard" data-url="/exploit-articles/the-dirtycow-exploit/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div class="navigation">
            <a class="nav nav-next" href="/exploit-articles/eternal-blue/index.html" title="Eternal Blue (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a>
          </div>
          <div class="navigation">
            <a class="nav nav-prev" href="/exploit-articles/samba-trans2open-exploit/index.html" title="Samba Trans2Open Exploit (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a>
          </div>
          <div id="top-print-link">
            <a class="print-link" title='Print whole chapter (CTRL+ALT+p)' href="/exploit-articles/the-dirtycow-exploit/index.print.html">
              <i class="fas fa-print fa-fw"></i>
            </a>
          </div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <span id="toc-menu" title='Table of Contents (CTRL+ALT+t)'><i class="fas fa-list-alt fa-fw"></i></span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/index.html"><span itemprop="name">solc0nf</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/exploit-articles/index.html"><span itemprop="name">Exploit Articles</span></a><meta itemprop="position" content="2"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">The Dirtycow Exploit</span><meta itemprop="position" content="3"></li>
            </ol>
          </div>
          <div class="default-animation progress">
            <div class="toc-wrapper" dir="ltr">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#dirtycow-cve-2016-5195">DirtyCOW (CVE-2016-5195)</a></li>
        <li><a href="#android-devices">Android devices</a></li>
        <li><a href="#references">References</a></li>
      </ul>
    </li>
  </ul>
</nav>
            </div>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
<div class="tags">
  <a class="tag-link" href="/tags/dirtycow/index.html">dirtycow</a>
  <a class="tag-link" href="/tags/exploit/index.html">exploit</a>
</div>
          </div>
          <article class="default">
<h1 id="the-dirtycow-exploit">The Dirtycow Exploit</h1>

<h3 id="dirtycow-cve-2016-5195">DirtyCOW (CVE-2016-5195)</h3>
<p>The DirtyCOW is a vulnerability in the Linux kernel which allowed processes, write access to read only memory mappings. This vulnerability was discovered by Phil Oester.</p>
<p>The vulnerability is called DirtyCOW because the issue is caused by a <em>race condition</em> <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> in the way the kernel handles <em>copy-on-write (COW)</em> COW is an optimization strategy used by operating systems. When multiple processes ask for resources, the system can give them pointers to the same resource. This state can be maintained until a program tries to modify its <em>copy</em> of the resource. When processes try to do this, a <em>private copy</em> of the resource is created so that other processes cannot read that data. The Linux kernel&rsquo;s COW implementation had a flaw which causes a race condition, allowing non-privileged users to alter root owned files. This flaw, effectively gives unprivileged local users write access to otherwise ready only memory mappings and thus elevate their privileges on the affected system.</p>
<p>The <em>dirty</em> part of the name comes from the <strong>Dirty Bit</strong>. A dirty bit or modified bit is a bit that is associated with a block of memory and indicates whether the corresponding block of memory has been modified. The dirty bit is set when the processor writes to (modifies) this memory. The dirty bit indicates that its associated block of memory has been modified and not saved to storage yet.</p>
<p>When a block of memory is to be replaced, its corresponding dirty bit is checked to see if the block needs to be written back to secondary memory before being replaced, or it can simply be removed. Dirty bits are used by CPU cache and page replacement algorithms of operating systems.</p>
<p>While most mainstream systems have been patched, there are several other Linux based embedded devices like access control devices, biometric scanners and employee attendance recording devices that are still vulnerable. Since these devices may not receive security updates, DirtyCOW still is an attack vector where such devices are used. The real risk of the vulnerability is when user level access and code execution ability, exists on the device.</p>
<p>The vulnerability was patched in Linux kernel versions 4.8.3, 4.7.9, 4.4.26 and newer. The first patch released in 2016 did not fully address remediation of the issue and a revised patch was released in November 2017, before public disclosure of the vulnerability.</p>
<p>Exploit code for this vulnerability is available on <a href="https://www.exploit-db.com/exploits/40839" target="_blank">https://www.exploit-db.com/exploits/40839</a>. You might have come across and probably ran this exploit while working <strong><a href="https://vulnhub.com" target="_blank">vulnhub</a></strong> machines.</p>
<p>A POC exploit is available on <a href="https://github.com/firefart/dirtycow" target="_blank">GitHub</a>. This exploit script needs to be compiled and run on the affected system in order for it to work.</p>
<p>A detection/scanner script for this vulnerability is available on <a href="https://access.redhat.com/sites/default/files/rh-cve-2016-5195_1.sh" target="_blank">https://access.redhat.com/sites/default/files/rh-cve-2016-5195_1.sh</a>.</p>
<h3 id="android-devices">Android devices</h3>
<p><strong>ZINU</strong> is the first malware for Android devices, which exploit the DirtyCOW vulnerability. It can be used to root any devices upto Android 7.0 Nougat. According to a report from security vendor TrendMicro, over 300,000 malicious apps carrying ZINU were reported in the wild, as of September 2017. Once the user launches an infected app, ZINU connects to its C&amp;C server, then uses the DirtyCOW exploit to gain root privileges to the device. While the exploit cannot be executed remotely, malicious apps can still plant backdoors and execute remote control attacks.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://www.secpod.com/blog/dirty-cow-vulnerability/" target="_blank">https://www.secpod.com/blog/dirty-cow-vulnerability/</a></li>
<li>A YouTube video explaining the exploit is <a href="https://www.youtube.com/watch?v=kEsshExn7aE" target="_blank">here</a>.</li>
<li><a href="https://www.makeuseof.com/tag/dirty-cow-vulnerability-everything-know/" target="_blank">https://www.makeuseof.com/tag/dirty-cow-vulnerability-everything-know/</a></li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>A race condition occurs when two or more threads can access shared data and they try to change it at the same time. Because the thread scheduling algorithm can swap between threads at any time, you don&rsquo;t know the order in which the threads will attempt to access the shared data. Therefore, the result of the change in data is dependent on the thread scheduling algorithm, i.e. both threads are <strong>&ldquo;racing&rdquo;</strong> to access/change the data.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="sidebar" class="default-animation showVisitedLinks" dir="ltr">
      <div id="header-wrapper" class="default-animation">
        <div id="header" class="default-animation">
<img src="/solconf.png"></img>
<h6>Solc0nf Systems</h6>
        </div>
        <form action="/search.html" method="get"><div class="searchbox default-animation">
          <button type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
          <label class="a11y-only" for="search-by">Search</label>
          <input data-search-input id="search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div></form>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1690804204" defer></script>
        <script src="/js/lunr/lunr.min.js?1690804204" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1690804204" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1690804204" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1690804204" defer></script>
        <script src="/js/search.js?1690804204" defer></script>
      </div>
      <div id="homelinks" class="default-animation">
        <ul>
          <li><a class="padding" href="/index.html"><i class="fas fa-home"></i> Home</a></li>
        </ul>
      </div>
      <div id="content-wrapper" class="highlightable">
        <ul class="topics collapsible-menu">
          <li data-nav-id="/exploit-articles/index.html" class="dd-item parent"><input type="checkbox" id="section-3b4d423a3ed6a06d19aa7b4fd218b430" aria-controls="subsections-3b4d423a3ed6a06d19aa7b4fd218b430" class="toggle" checked><label class="a11y-only toggle" for="section-3b4d423a3ed6a06d19aa7b4fd218b430" >Submenu Exploit Articles</label><a href="/exploit-articles/index.html">Exploit Articles<i class="fas fa-check read-icon"></i></a><ul id="subsections-3b4d423a3ed6a06d19aa7b4fd218b430">
          <li data-nav-id="/exploit-articles/dirty-pipe/index.html" class="dd-item"><a href="/exploit-articles/dirty-pipe/index.html">Dirty Pipe<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/exploit-articles/shellshock/index.html" class="dd-item"><a href="/exploit-articles/shellshock/index.html">ShellShock<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/exploit-articles/samba-trans2open-exploit/index.html" class="dd-item"><a href="/exploit-articles/samba-trans2open-exploit/index.html">Samba Trans2Open Exploit<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/exploit-articles/the-dirtycow-exploit/index.html" class="dd-item active"><a href="/exploit-articles/the-dirtycow-exploit/index.html">The Dirtycow Exploit<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/exploit-articles/eternal-blue/index.html" class="dd-item"><a href="/exploit-articles/eternal-blue/index.html">Eternal Blue<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/linux-howto/index.html" class="dd-item"><input type="checkbox" id="section-2d4257959db23532f0d2a8f029bc3b96" aria-controls="subsections-2d4257959db23532f0d2a8f029bc3b96" class="toggle"><label class="a11y-only toggle" for="section-2d4257959db23532f0d2a8f029bc3b96" >Submenu Linux How To</label><a href="/linux-howto/index.html">Linux How To<i class="fas fa-check read-icon"></i></a><ul id="subsections-2d4257959db23532f0d2a8f029bc3b96">
          <li data-nav-id="/linux-howto/apache2-custom-site-with-self-signed-certificate/index.html" class="dd-item"><a href="/linux-howto/apache2-custom-site-with-self-signed-certificate/index.html">Apache2 Custom Site With Self Signed Certificate<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/linux-howto/encrypt-and-share-files-with-gpg/index.html" class="dd-item"><a href="/linux-howto/encrypt-and-share-files-with-gpg/index.html">Encrypt and Share Files With Gpg<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/linux-howto/secure-passwords-in-linux/index.html" class="dd-item"><a href="/linux-howto/secure-passwords-in-linux/index.html">Secure Passwords in Linux<i class="fas fa-check read-icon"></i></a></li></ul></li>
        </ul>
        <div id="shortcuts">
          <div class="nav-title">More</div>
          <ul>
            <li><a class="padding" href="/tags/index.html"><i class='fas fa-tags'></i> Tags</a></li>
          </ul>
        </div>
        <div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div>
        <hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter">
        <div id="prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks">
          <ul>
            <li id="select-language-container" class="footerLangSwitch">
              <div class="padding select-container">
                <i class="fas fa-language fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-language">Language</label>
                  <select id="select-language" onchange="location = baseUri + this.value;">
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
            </li>
            <li id="select-variant-container" class="footerVariantSwitch">
              <div class="padding select-container">
                <i class="fas fa-paint-brush fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-variant">Theme</label>
                  <select id="select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                    <option id="relearn-dark" value="relearn-dark" selected>Relearn Dark</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
              <script>window.variants && variants.markSelectedVariant();</script>
            </li>
            <li class="footerVisitedLinks showVisitedLinks"><button class="padding" onclick="clearHistory();"><i class="fas fa-history fa-fw"></i> Clear History</button></li>
          </ul>
        </div>
        <div id="footer" class="footerFooter showFooter">
	    <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1690804204" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1690804204" defer></script>
    <script src="/js/featherlight.min.js?1690804204" defer></script>
    <script src="/js/theme.js?1690804204" defer></script>
  </body>
</html>
