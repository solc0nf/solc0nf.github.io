<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.108.0">
    <meta name="generator" content="Relearn 5.9.4+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="Exploit writeups, info sec articles..">
    <meta name="author" content="solc0nf">
    <title>Eternal Blue :: solc0nf</title>
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1690802202" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1690802202" rel="stylesheet"></noscript>
    <link href="/css/featherlight.min.css?1690802202" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/featherlight.min.css?1690802202" rel="stylesheet"></noscript>
    <link href="/css/auto-complete.css?1690802202" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1690802202" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1690802202" rel="stylesheet">
    <link href="/css/nucleus.css?1690802202" rel="stylesheet">
    <link href="/css/fonts.css?1690802202" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1690802202" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1690802202" rel="stylesheet">
    <link href="/css/theme-relearn-dark.css?1690802202" rel="stylesheet" id="variant-style">
    <link href="/css/ie.css?1690802202" rel="stylesheet">
    <link href="/css/variant.css?1690802202" rel="stylesheet">
    <link href="/css/print.css?1690802202" rel="stylesheet" media="print">
    <link href="/css/format-print.css?1690802202" rel="stylesheet">
    <script src="/js/url.js?1690802202"></script>
    <script src="/js/variant.js?1690802202"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/solc0nf.github.io/';
      window.variants && variants.init( [ 'relearn-dark' ] );
    </script>
    <script src="/js/jquery.min.js?1690802202" defer></script>
  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/exploit-articles/eternal-blue/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/index.html"><span itemprop="name">solc0nf</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/exploit-articles/index.html"><span itemprop="name">Exploit Articles</span></a><meta itemprop="position" content="2"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Eternal Blue</span><meta itemprop="position" content="3"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
<div class="tags">
  <a class="tag-link" href="/tags/eternalblue/index.html">eternalblue</a>
  <a class="tag-link" href="/tags/exploit/index.html">exploit</a>
</div>
          </div>
          <article class="default">
<h1 id="eternal-blue">Eternal Blue</h1>

<figure><img src="/images/EternalBlue.png" height="300px"/>
</figure>

<p><strong>EternalBlue</strong> is the name given to a series of Microsoft software vulnerabilities, as well as an exploit developed by the Unites State&rsquo;s NSA, as a cyber attack tool. Although the EternalBlue exploit affects only Windows operating systems, anything that uses the SMBv1 file sharing protocol is vulnerable to attack, such as <em>Siemens ultrasound medical equipment</em>.</p>
<p>EternalBlue was developed the NSA as a part of their controversial program of stockpiling and weaponizing cybersecurity vulnerabilities, rather that flagging those to the appropriate vendor for remediation. The NSA used EternalBlue for 5 years, before alerting Microsoft of its existence. This was probable due to the fact that a group of hackers called <strong>The Shadow Brokers</strong> hacked the NSA and released their cyber weaponry to the wild. EternalBlue was released as the fifth is a series, the title of the release being <strong>Lost in Translation</strong>. This was done via a link on their Twitter account, on April 14, 2017.</p>
<figure><img src="/images/EternalBlue-1.png"/>
</figure>

<blockquote>
<p>Before it leaked, EternalBlue was one of the most useful exploits in the NSA&rsquo;s arsenal, used in countless intelligence gathering and counter-terrorism operations. - The New York Times.</p>
</blockquote>
<p>In short, the NSA discovers the EternalBlue vulnerability and develops an exploit which then was used for their operations for a period of 5 years. Then, they get hacked by The Shadow Brokers, leaving the NSA with no other option than to inform Microsoft if its existence. Microsoft in turn, released the patch <strong>MS17-010</strong>. This patch was designed to fix the EternalBlue vulnerability in all versions of Windows including Windows Vista, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2021 and Windows Server 2016.</p>
<p>Due to the severity of the vulnerability and the sheer number of devices out there, Microsoft also released patched for unsupported versions of Windows like XP and Server 2003.</p>
<h2 id="how-the-exploit-works">How the exploit works.</h2>
<figure><img src="/images/EternalBlue-2.png"/>
</figure>

<p>The exploit works by taking advantage of the vulnerabilities present in <strong>SMBv1 protocol</strong> in older versions of Windows. SMBv1 was first developed in 1983 as a network communication protocol to enable shared access to file and printers (among others).
The exploit makes use of the way Windows handles (or mishandles) specially crafted packets from malicious attackers. Once the attacker send a specially crafted packet to the target server, he could potentially get elevated privileges to the target server. From the target, the attacker could then, potentially move laterally across the network, further compromising other machines.</p>
<p>The EternalBlue vulnerability has been famously used to spread the WannaCry, Petya and NotPetya ransomware. The WannaCry cyber attack began on May 2017, spreading at the rate of 16,000 devices per hour, infecting over 230,000 Windows computers across 150 countries in a single day.</p>
<p>Almost a million computers still use the vulnerable SMBv1 protocol and remain online. As long as these machines remain unpatched, EternalBlue truly will remain <strong>ETERNAL</strong>.</p>
<p>Resource Links:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010" target="_blank">Microsoft Security Bulletin MS17-010 - Critical</a></li>
<li><a href="https://www.avast.com/c-eternalblue" target="_blank">What Is EternalBlue and Why Is the MS17-010 Exploit Still Relevant?</a></li>
</ul>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <script src="/js/clipboard.min.js?1690802202" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1690802202" defer></script>
    <script src="/js/featherlight.min.js?1690802202" defer></script>
    <script src="/js/theme.js?1690802202" defer></script>
  </body>
</html>
